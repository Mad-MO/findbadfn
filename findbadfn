#!/bin/bash



# Based on the filename restrictions of Windows:
# https://learn.microsoft.com/en-us/windows/win32/fileio/naming-a-file
#
# This script searches for files and directories that use the following reserved characters:
#  < (less than)
#  > (greater than)
#  : (colon)
#  " (double quote)
#  / (forward slash)
#  \ (backslash)
#  | (vertical bar or pipe)
#  ? (question mark)
#  * (asterisk)
#
# It also searches for files that use the following forbidden names:
# CON, PRN, AUX, NUL, COM0, COM1, COM2, COM3, COM4, COM5, COM6, COM7, COM8, COM9, COM¹, COM², COM³, LPT0, LPT1, LPT2, LPT3, LPT4, LPT5, LPT6, LPT7, LPT8, LPT9, LPT¹, LPT², and LPT³



echo
echo "Find empty files / dirs"
find $1 -empty \
  | sort \
  | grep -v "Trash-1000" \
  | grep -v "lost+found"



echo
echo "Find trailing spaces"
find $1 -name "*[ ]" \
  | sort



echo
echo "Find Trailing dots"
find $1 -name "*[\.]" \
  | sort



echo
echo "Find bad characters"
find $1 -name '*[\<\>\:\"\\\|\?\*]*' \
  | sort



echo
echo "Find control characters"
find $1 -name '*[[:cntrl:]*' \
  | sort



echo
echo "Find reserved names"
find $1 -iname 'CON' \
     -o -iname 'PRN' \
     -o -iname 'AUX' \
     -o -iname 'NUL' \
     -o -iname 'COM[0-9¹²³]' \
     -o -iname 'LPT[0-9¹²³]' \
  | sort



echo
echo "Find identical names when ignoring case"
find $1 \
  | sort \
  | tr '[:upper:]' '[:lower:]' \
  | uniq -d

